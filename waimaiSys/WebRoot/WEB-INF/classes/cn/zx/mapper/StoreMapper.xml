<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.zx.mapper.StoreMapper">
    <!-- 当数据库中的字段信息与对象的属性不一致时需要通过resultMap来映射 -->
   	<!--  <resultMap type="User" id="userList">
        <result property="userRoleName" column="roleName" />
    </resultMap> -->
    
     <!-- 查询所有商家 -->
    <select id="findStoreByAddress" parameterType="store" resultType="store" >
    	SELECT * FROM store s INNER JOIN store_storetypes sst ON s.id=sst.`storeId` where province=#{province} and  city=#{city} and area=#{area}
    	<if test="storeTypeId!=null">
    		and sst.`storeTypeId`=#{storeTypeId}
    	</if>
    </select>
    
    <!-- 根据id查询商家 -->
    <select id="findStoreById" parameterType="Integer" resultType="store">
    	select * from store where id=#{id}
    </select>
    
    <!-- 账号密码登录 -->
    <select id="phonePwdLogin" parameterType="store" resultType="store" >
    	SELECT * FROM store where storePhone=#{storePhone} and storePassword=#{storePassword} and registState=#{registState}
    </select>
    
    <!-- 手机号登录 -->
    <select id="storePhoneLogin" resultType="store" >
    	SELECT * FROM store where storePhone=#{phone} and registState=1
    </select>
    
    <!-- 新增店铺 -->
    <insert id="addStore" parameterType="store">
    	INSERT INTO `waimai`.`store` (
		  `storePhone`,
		  `storePassword`
		) 
		VALUES
		  (
		    #{storePhone},
		    #{storePassword}
		   ) ;
    </insert>
    
    <!-- 修改店铺 -->
    <update id="updateStore" parameterType="store">
    	UPDATE 
		  `waimai`.`store` 
		SET
		  `distributionMoney` = #{distributionMoney},
		  `startMoney` = #{startMoney},
		  `storeAddress` = #{storeAddress},
		  `storeName` = #{storeName},
		  `storePhone` = #{storePhone},
		  `storePassword` = #{storePassword},
		  `storeImg` = #{storeImg},
		  `province` = #{province},
		  `city` = #{city},
		  `area` = #{area},
		  `coordinate` = #{coordinate},
		  `registState` = #{registState}
		WHERE `id` = #{id};
    </update>
</mapper>